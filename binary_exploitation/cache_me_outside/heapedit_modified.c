
int main(void)

{
  long in_FS_OFFSET;
  undefined value;
  int address;
  int i;
  undefined8 *first_heap_allocation;
  undefined8 *winning_string;
  FILE *file_pointer;
  undefined8 *losing_string;
  void *final_allocation;
  char random_string [25];
  char flag_buffer [72];
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  setbuf(stdout,(char *)0x0);
  file_pointer = fopen("flag.txt","r");
  fgets(flag_buffer,0x40,file_pointer);

  random_string._0_8_ = 0x2073692073696874;
  random_string._8_8_ = 0x6d6f646e61722061;
  random_string._16_8_ = 0x2e676e6972747320;
  random_string[24] = '\0';

  first_heap_allocation = (undefined8 *)0x0;
  for (i = 0; i < 7; i = i + 1) {
    winning_string = (undefined8 *)malloc(0x80);
    if (first_heap_allocation == (undefined8 *)0x0) {
      first_heap_allocation = winning_string;
    }
    *winning_string = 0x73746172676e6f43;
    winning_string[1] = 0x662072756f592021;
    winning_string[2] = 0x203a73692067616c;
    *(undefined *)(winning_string + 3) = 0;
    strcat((char *)winning_string,flag_buffer);
  }
  losing_string = (undefined8 *)malloc(0x80);

  *losing_string = 0x5420217972726f53;
  losing_string[1] = 0x276e6f7720736968;
  losing_string[2] = 0x7920706c65682074;
  *(undefined4 *)(losing_string + 3) = 0x203a756f;
  *(undefined *)((long)losing_string + 0x1c) = 0;

  strcat((char *)losing_string,random_string);
  free(winning_string);
  free(losing_string);
  
  address = 0;
  value = 0;
  puts("You may edit one byte in the program.");
  printf("Address: ");
  __isoc99_scanf("%d",&address);
  printf("Value: ");
  __isoc99_scanf(" %c",&value);
  *(undefined *)((long)address + (long)first_heap_allocation) = value;
  final_allocation = malloc(0x80);
  puts((char *)((long)final_allocation + 0x10));
  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return 0;